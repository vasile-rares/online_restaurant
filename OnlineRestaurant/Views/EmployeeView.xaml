<UserControl
    x:Class="OnlineRestaurant.Views.EmployeeView"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
    xmlns:local="clr-namespace:OnlineRestaurant.Views"
    xmlns:viewmodels="clr-namespace:OnlineRestaurant.ViewModels"
    xmlns:models="clr-namespace:OnlineRestaurant.Models"
    xmlns:converters="clr-namespace:OnlineRestaurant.Converters"
    mc:Ignorable="d" 
    d:DesignHeight="800" d:DesignWidth="1200"
    Background="#F5F5F5"
    RenderOptions.EdgeMode="Aliased">

    <UserControl.Resources>
        <converters:NullToVisibilityConverter x:Key="NullToVisibilityConverter" />
        <BooleanToVisibilityConverter x:Key="BooleanToVisibilityConverter" />
        <converters:StringToVisibilityConverter x:Key="StringVisibilityConverter" />
        <converters:LessThanConverter x:Key="LessThanConverter" />

        <!-- Common styles -->
        <Style x:Key="HeaderTextStyle" TargetType="TextBlock">
            <Setter Property="FontSize" Value="24" />
            <Setter Property="FontWeight" Value="SemiBold" />
            <Setter Property="Foreground" Value="#333333" />
        </Style>

        <Style x:Key="SubHeaderTextStyle" TargetType="TextBlock">
            <Setter Property="FontSize" Value="18" />
            <Setter Property="FontWeight" Value="SemiBold" />
            <Setter Property="Foreground" Value="#333333" />
        </Style>

        <Style x:Key="StandardButtonStyle" TargetType="Button">
            <Setter Property="Padding" Value="15,8" />
            <Setter Property="Margin" Value="0,0,10,0" />
            <Setter Property="Background" Value="#4CAF50" />
            <Setter Property="Foreground" Value="White" />
            <Setter Property="BorderThickness" Value="0" />
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border Background="{TemplateBinding Background}"
                                CornerRadius="4"
                                Padding="{TemplateBinding Padding}">
                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center" />
                        </Border>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
            <Style.Triggers>
                <Trigger Property="IsMouseOver" Value="True">
                    <Setter Property="Background" Value="#43A047" />
                </Trigger>
                <Trigger Property="IsEnabled" Value="False">
                    <Setter Property="Opacity" Value="0.5" />
                    <Setter Property="Background" Value="#9E9E9E" />
                </Trigger>
            </Style.Triggers>
        </Style>

        <Style x:Key="DangerButtonStyle" TargetType="Button" BasedOn="{StaticResource StandardButtonStyle}">
            <Setter Property="Background" Value="#E74C3C" />
            <Style.Triggers>
                <Trigger Property="IsMouseOver" Value="True">
                    <Setter Property="Background" Value="#C0392B" />
                </Trigger>
            </Style.Triggers>
        </Style>

        <Style x:Key="NeutralButtonStyle" TargetType="Button" BasedOn="{StaticResource StandardButtonStyle}">
            <Setter Property="Background" Value="#757575" />
            <Style.Triggers>
                <Trigger Property="IsMouseOver" Value="True">
                    <Setter Property="Background" Value="#616161" />
                </Trigger>
            </Style.Triggers>
        </Style>

        <Style x:Key="TabItemStyle" TargetType="TabItem">
            <Setter Property="Foreground" Value="#757575" />
            <Setter Property="Background" Value="Transparent" />
            <Setter Property="Padding" Value="15,8" />
            <Setter Property="Margin" Value="0,0,2,0" />
            <Setter Property="FontWeight" Value="Medium" />
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="TabItem">
                        <Grid>
                            <Border x:Name="MainBorder"
                                    Background="Transparent"
                                    CornerRadius="4,4,0,0"
                                    BorderThickness="0,0,0,3"
                                    BorderBrush="Transparent"
                                    Margin="{TemplateBinding Margin}"
                                    Padding="{TemplateBinding Padding}">
                                <ContentPresenter x:Name="ContentSite"
                                                  ContentSource="Header"
                                                  HorizontalAlignment="Center"
                                                  VerticalAlignment="Center" />
                            </Border>
                        </Grid>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsSelected" Value="True">
                                <Setter TargetName="MainBorder" Property="Background" Value="White" />
                                <Setter TargetName="MainBorder" Property="BorderBrush" Value="#4CAF50" />
                                <Setter TargetName="ContentSite" Property="TextElement.Foreground" Value="#333333" />
                                <Setter TargetName="ContentSite" Property="TextElement.FontWeight" Value="SemiBold" />
                            </Trigger>
                            <MultiTrigger>
                                <MultiTrigger.Conditions>
                                    <Condition Property="IsMouseOver" Value="True" />
                                    <Condition Property="IsSelected" Value="False" />
                                </MultiTrigger.Conditions>
                                <Setter TargetName="MainBorder" Property="Background" Value="#F5F5F5" />
                                <Setter TargetName="ContentSite" Property="TextElement.Foreground" Value="#4CAF50" />
                            </MultiTrigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <Style x:Key="ListViewStyle" TargetType="ListView">
            <Setter Property="BorderThickness" Value="1" />
            <Setter Property="BorderBrush" Value="#E0E0E0" />
            <Setter Property="Background" Value="White" />
        </Style>

        <Style x:Key="CardBorderStyle" TargetType="Border">
            <Setter Property="Background" Value="White" />
            <Setter Property="BorderThickness" Value="1" />
            <Setter Property="BorderBrush" Value="#E0E0E0" />
            <Setter Property="CornerRadius" Value="8" />
            <Setter Property="Padding" Value="15" />
            <Setter Property="Margin" Value="0,0,0,15" />
        </Style>
    </UserControl.Resources>

    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto" />
            <RowDefinition Height="*" />
        </Grid.RowDefinitions>

        <!-- Header -->
        <Border Grid.Row="0" Background="White" Padding="25,15" BorderThickness="0,0,0,1" BorderBrush="#E0E0E0">
            <TextBlock Text="Restaurant Management Dashboard"
                       Style="{StaticResource HeaderTextStyle}"
                       HorizontalAlignment="Left" />
        </Border>

        <!-- Main Content -->
        <Grid Grid.Row="1" Margin="15">
            <TabControl Background="Transparent" BorderThickness="0">
                <TabControl.Resources>
                    <Style TargetType="TabItem" BasedOn="{StaticResource TabItemStyle}" />
                </TabControl.Resources>

                <!-- All Orders Tab -->
                <TabItem Header="All Orders">
                    <Grid Margin="10">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="*" />
                        </Grid.RowDefinitions>

                        <Border Grid.Row="0" Style="{StaticResource CardBorderStyle}" Margin="0,0,0,15">
                            <StackPanel>
                                <TextBlock Text="Manage All Orders" Style="{StaticResource SubHeaderTextStyle}" Margin="0,0,0,10" />
                            <Button Content="Refresh Orders" Command="{Binding LoadAllOrdersCommand}" 
                                        Style="{StaticResource NeutralButtonStyle}" HorizontalAlignment="Left" />
                        </StackPanel>
                        </Border>

                        <ListView Grid.Row="1" ItemsSource="{Binding AllOrders}" 
                                  SelectedItem="{Binding SelectedOrder, Mode=TwoWay}"
                                  Style="{StaticResource ListViewStyle}">
                            <ListView.View>
                                <GridView>
                                    <GridViewColumn Header="Order Date" Width="150">
                                        <GridViewColumn.CellTemplate>
                                            <DataTemplate>
                                                <TextBlock Text="{Binding OrderDate, StringFormat='{}{0:dd/MM/yyyy HH:mm}'}" />
                                            </DataTemplate>
                                        </GridViewColumn.CellTemplate>
                                    </GridViewColumn>
                                    <GridViewColumn Header="Order ID" Width="120"
                                                   DisplayMemberBinding="{Binding IdOrder}" />
                                    <GridViewColumn Header="Customer" Width="180">
                                        <GridViewColumn.CellTemplate>
                                            <DataTemplate>
                                                <TextBlock Text="{Binding User.FullName}" />
                                            </DataTemplate>
                                        </GridViewColumn.CellTemplate>
                                    </GridViewColumn>
                                    <GridViewColumn Header="Phone" Width="120" 
                                                    DisplayMemberBinding="{Binding User.Phone}" />
                                    <GridViewColumn Header="Total Amount" Width="100">
                                        <GridViewColumn.CellTemplate>
                                            <DataTemplate>
                                                <TextBlock Text="{Binding TotalAmount, StringFormat='{}{0:C}'}" 
                                                           HorizontalAlignment="Right" />
                                            </DataTemplate>
                                        </GridViewColumn.CellTemplate>
                                    </GridViewColumn>
                                    <GridViewColumn Header="Status" Width="120">
                                        <GridViewColumn.CellTemplate>
                                            <DataTemplate>
                                                <TextBlock Text="{Binding Status}">
                                                    <TextBlock.Style>
                                                        <Style TargetType="TextBlock">
                                                            <Style.Triggers>
                                                                <DataTrigger Binding="{Binding Status}" Value="cancelled">
                                                                    <Setter Property="Foreground" Value="#E74C3C" />
                                                                    <Setter Property="FontWeight" Value="SemiBold" />
                                                                </DataTrigger>
                                                                <DataTrigger Binding="{Binding Status}" Value="delivered">
                                                                    <Setter Property="Foreground" Value="#27AE60" />
                                                                    <Setter Property="FontWeight" Value="SemiBold" />
                                                                </DataTrigger>
                                                                <DataTrigger Binding="{Binding Status}" Value="preparing">
                                                                    <Setter Property="Foreground" Value="#F39C12" />
                                                                    <Setter Property="FontWeight" Value="SemiBold" />
                                                                </DataTrigger>
                                                                <DataTrigger Binding="{Binding Status}" Value="out_for_delivery">
                                                                    <Setter Property="Foreground" Value="#3498DB" />
                                                                    <Setter Property="FontWeight" Value="SemiBold" />
                                                                </DataTrigger>
                                                            </Style.Triggers>
                                                        </Style>
                                                    </TextBlock.Style>
                                                </TextBlock>
                                            </DataTemplate>
                                        </GridViewColumn.CellTemplate>
                                    </GridViewColumn>
                                </GridView>
                            </ListView.View>
                        </ListView>
                    </Grid>
                </TabItem>

                <!-- Active Orders Tab -->
                <TabItem Header="Active Orders">
                    <Grid Margin="10">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="*" />
                        </Grid.RowDefinitions>

                        <Border Grid.Row="0" Style="{StaticResource CardBorderStyle}" Margin="0,0,0,15">
                            <StackPanel>
                                <TextBlock Text="Manage Active Orders" Style="{StaticResource SubHeaderTextStyle}" Margin="0,0,0,10" />
                            <Button Content="Refresh Active Orders" Command="{Binding LoadActiveOrdersCommand}" 
                                        Style="{StaticResource NeutralButtonStyle}" HorizontalAlignment="Left" />
                        </StackPanel>
                        </Border>

                        <Grid Grid.Row="1">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*" />
                                <ColumnDefinition Width="Auto" />
                                <ColumnDefinition Width="*" />
                            </Grid.ColumnDefinitions>

                            <!-- Orders List - Left Side -->
                            <ListView Grid.Column="0" ItemsSource="{Binding ActiveOrders}"
                                  SelectedItem="{Binding SelectedOrder, Mode=TwoWay}"
                                      Style="{StaticResource ListViewStyle}">
                            <ListView.View>
                                <GridView>
                                    <GridViewColumn Header="Order Date" Width="150">
                                        <GridViewColumn.CellTemplate>
                                            <DataTemplate>
                                                <TextBlock Text="{Binding OrderDate, StringFormat='{}{0:dd/MM/yyyy HH:mm}'}" />
                                            </DataTemplate>
                                        </GridViewColumn.CellTemplate>
                                    </GridViewColumn>
                                        <GridViewColumn Header="Order ID" Width="120"
                                                       DisplayMemberBinding="{Binding IdOrder}" />
                                        <GridViewColumn Header="Customer" Width="180">
                                        <GridViewColumn.CellTemplate>
                                            <DataTemplate>
                                                <TextBlock Text="{Binding User.FullName}" />
                                            </DataTemplate>
                                        </GridViewColumn.CellTemplate>
                                    </GridViewColumn>
                                        <GridViewColumn Header="Status" Width="120">
                                            <GridViewColumn.CellTemplate>
                                                <DataTemplate>
                                                    <TextBlock Text="{Binding Status}">
                                                        <TextBlock.Style>
                                                            <Style TargetType="TextBlock">
                                                                <Style.Triggers>
                                                                    <DataTrigger Binding="{Binding Status}" Value="cancelled">
                                                                        <Setter Property="Foreground" Value="#E74C3C" />
                                                                        <Setter Property="FontWeight" Value="SemiBold" />
                                                                    </DataTrigger>
                                                                    <DataTrigger Binding="{Binding Status}" Value="delivered">
                                                                        <Setter Property="Foreground" Value="#27AE60" />
                                                                        <Setter Property="FontWeight" Value="SemiBold" />
                                                                    </DataTrigger>
                                                                    <DataTrigger Binding="{Binding Status}" Value="preparing">
                                                                        <Setter Property="Foreground" Value="#F39C12" />
                                                                        <Setter Property="FontWeight" Value="SemiBold" />
                                                                    </DataTrigger>
                                                                    <DataTrigger Binding="{Binding Status}" Value="out_for_delivery">
                                                                        <Setter Property="Foreground" Value="#3498DB" />
                                                                        <Setter Property="FontWeight" Value="SemiBold" />
                                                                    </DataTrigger>
                                                                </Style.Triggers>
                                                            </Style>
                                                        </TextBlock.Style>
                                                    </TextBlock>
                                                </DataTemplate>
                                            </GridViewColumn.CellTemplate>
                                        </GridViewColumn>
                                        <GridViewColumn Header="Total" Width="100">
                                        <GridViewColumn.CellTemplate>
                                            <DataTemplate>
                                                <TextBlock Text="{Binding TotalAmount, StringFormat='{}{0:C}'}" 
                                                               HorizontalAlignment="Right"
                                                               Foreground="#4CAF50"
                                                               FontWeight="SemiBold" />
                                            </DataTemplate>
                                        </GridViewColumn.CellTemplate>
                                    </GridViewColumn>
                                </GridView>
                            </ListView.View>
                        </ListView>

                            <!-- Separator -->
                            <GridSplitter Grid.Column="1" Width="5" Margin="10,0"
                                          HorizontalAlignment="Center" VerticalAlignment="Stretch"
                                          Background="#E0E0E0" />

                            <!-- Order Details - Right Side -->
                            <ScrollViewer Grid.Column="2" VerticalScrollBarVisibility="Auto">
                                <StackPanel>
                                    <!-- Message when no order is selected -->
                                    <Border Style="{StaticResource CardBorderStyle}"
                                            Visibility="{Binding SelectedOrder, Converter={StaticResource NullToVisibilityConverter}, ConverterParameter=true}">
                                        <TextBlock Text="Select an order to view details"
                                                   HorizontalAlignment="Center"
                                                   Foreground="#757575"
                                                   FontSize="16" />
                                    </Border>

                                    <!-- Order Info Card - Only visible when order selected -->
                                    <Border Style="{StaticResource CardBorderStyle}" Margin="0,0,0,15"
                                            Visibility="{Binding SelectedOrder, Converter={StaticResource NullToVisibilityConverter}}">
                                        <StackPanel>
                                            <TextBlock Text="Order Details" Style="{StaticResource SubHeaderTextStyle}" Margin="0,0,0,15" />

                                            <Grid>
                                        <Grid.ColumnDefinitions>
                                                    <ColumnDefinition Width="140" />
                                                    <ColumnDefinition Width="*" />
                                        </Grid.ColumnDefinitions>
                                        <Grid.RowDefinitions>
                                                    <RowDefinition Height="Auto" />
                                                    <RowDefinition Height="Auto" />
                                                    <RowDefinition Height="Auto" />
                                                    <RowDefinition Height="Auto" />
                                                    <RowDefinition Height="Auto" />
                                                    <RowDefinition Height="Auto" />
                                        </Grid.RowDefinitions>

                                                <TextBlock Grid.Row="0" Grid.Column="0" Text="Order ID:" FontWeight="SemiBold" Margin="0,0,10,8" Foreground="#333333" />
                                                <TextBlock Grid.Row="0" Grid.Column="1" Text="{Binding SelectedOrder.IdOrder}" Margin="0,0,0,8" Foreground="#757575" />

                                                <TextBlock Grid.Row="1" Grid.Column="0" Text="Date:" FontWeight="SemiBold" Margin="0,0,10,8" Foreground="#333333" />
                                                <TextBlock Grid.Row="1" Grid.Column="1" Text="{Binding SelectedOrder.OrderDate, StringFormat='{}{0:dd/MM/yyyy HH:mm}'}" Margin="0,0,0,8" Foreground="#757575" />

                                                <TextBlock Grid.Row="2" Grid.Column="0" Text="Customer:" FontWeight="SemiBold" Margin="0,0,10,8" Foreground="#333333" />
                                                <TextBlock Grid.Row="2" Grid.Column="1" Text="{Binding SelectedOrder.User.FullName}" Margin="0,0,0,8" Foreground="#757575" />
                                        
                                                <TextBlock Grid.Row="3" Grid.Column="0" Text="Phone:" FontWeight="SemiBold" Margin="0,0,10,8" Foreground="#333333" />
                                                <TextBlock Grid.Row="3" Grid.Column="1" Text="{Binding SelectedOrder.User.Phone}" Margin="0,0,0,8" Foreground="#757575" />
                                        
                                                <TextBlock Grid.Row="4" Grid.Column="0" Text="Delivery Address:" FontWeight="SemiBold" Margin="0,0,10,8" Foreground="#333333" />
                                                <TextBlock Grid.Row="4" Grid.Column="1" Text="{Binding SelectedOrder.User.DeliveryAddress}" Margin="0,0,0,8" Foreground="#757575" TextWrapping="Wrap" />

                                                <TextBlock Grid.Row="5" Grid.Column="0" Text="Total Amount:" FontWeight="SemiBold" Margin="0,0,10,8" Foreground="#333333" />
                                                <TextBlock Grid.Row="5" Grid.Column="1" Text="{Binding SelectedOrder.TotalAmount, StringFormat='{}{0:C}'}" Margin="0,0,0,8" Foreground="#4CAF50" FontWeight="SemiBold" />
                                    </Grid>
                                </StackPanel>
                                    </Border>

                                    <!-- Order Items Card -->
                                    <Border Style="{StaticResource CardBorderStyle}" Margin="0,0,0,15"
                                            Visibility="{Binding SelectedOrder, Converter={StaticResource NullToVisibilityConverter}}">
                                        <StackPanel>
                                            <TextBlock Text="Order Items" Style="{StaticResource SubHeaderTextStyle}" Margin="0,0,0,15" />

                                            <!-- Dishes Section -->
                                            <Border Background="#F9F9F9" CornerRadius="4" Margin="0,5,0,10"
                                                     BorderThickness="1" BorderBrush="#E0E0E0" Padding="8"
                                                     Visibility="{Binding SelectedOrder.OrderDishes.Count, Converter={StaticResource LessThanConverter}, ConverterParameter=1, FallbackValue=Collapsed}">
                                                <TextBlock Text="No dishes in this order" Foreground="#757575" FontStyle="Italic" />
                                            </Border>

                                            <ItemsControl ItemsSource="{Binding SelectedOrder.OrderDishes}">
                                                <ItemsControl.Style>
                                                    <Style TargetType="ItemsControl">
                                                        <Setter Property="Visibility" Value="Collapsed" />
                                                        <Style.Triggers>
                                                            <DataTrigger Binding="{Binding SelectedOrder.OrderDishes.Count}" Value="0">
                                                                <Setter Property="Visibility" Value="Collapsed" />
                                                            </DataTrigger>
                                                            <DataTrigger Binding="{Binding SelectedOrder.OrderDishes.Count, Converter={StaticResource LessThanConverter}, ConverterParameter=1}" Value="False">
                                                                <Setter Property="Visibility" Value="Visible" />
                                                            </DataTrigger>
                                                        </Style.Triggers>
                                                    </Style>
                                                </ItemsControl.Style>
                                                <ItemsControl.ItemTemplate>
                                                    <DataTemplate>
                                                        <Border Background="#F9F9F9" CornerRadius="4" Margin="0,0,0,5"
                                                                BorderThickness="1" BorderBrush="#E0E0E0" Padding="10">
                                                            <Grid>
                                                                <Grid.ColumnDefinitions>
                                                                    <ColumnDefinition Width="*" />
                                                                    <ColumnDefinition Width="Auto" />
                                                                    <ColumnDefinition Width="Auto" />
                                                                </Grid.ColumnDefinitions>
                                                                <TextBlock Grid.Column="0" Text="{Binding Dish.Name}" FontWeight="SemiBold" />
                                                                <TextBlock Grid.Column="1" Text="{Binding Quantity, StringFormat='x{0}'}" Margin="15,0" Foreground="#757575" />
                                                                <TextBlock Grid.Column="2" Text="{Binding Dish.Price, StringFormat='{}{0:C}'}" Foreground="#4CAF50" />
                                                            </Grid>
                                                        </Border>
                                                    </DataTemplate>
                                                </ItemsControl.ItemTemplate>
                                            </ItemsControl>

                                            <!-- Menus Section -->
                                            <TextBlock Text="Menus" FontWeight="SemiBold" Margin="0,15,0,5" Foreground="#333333"
                                                       Visibility="{Binding SelectedOrder.OrderMenus.Count, Converter={StaticResource BooleanToVisibilityConverter}, FallbackValue=Collapsed}" />

                                            <Border Background="#F9F9F9" CornerRadius="4" Margin="0,5,0,10"
                                                     BorderThickness="1" BorderBrush="#E0E0E0" Padding="8"
                                                     Visibility="{Binding SelectedOrder.OrderMenus.Count, Converter={StaticResource LessThanConverter}, ConverterParameter=1, FallbackValue=Collapsed}">
                                                <TextBlock Text="No menus in this order" Foreground="#757575" FontStyle="Italic" />
                                            </Border>

                                            <ItemsControl ItemsSource="{Binding SelectedOrder.OrderMenus}">
                                                <ItemsControl.Style>
                                                    <Style TargetType="ItemsControl">
                                                        <Setter Property="Visibility" Value="Collapsed" />
                                                        <Style.Triggers>
                                                            <DataTrigger Binding="{Binding SelectedOrder.OrderMenus.Count}" Value="0">
                                                                <Setter Property="Visibility" Value="Collapsed" />
                                                            </DataTrigger>
                                                            <DataTrigger Binding="{Binding SelectedOrder.OrderMenus.Count, Converter={StaticResource LessThanConverter}, ConverterParameter=1}" Value="False">
                                                                <Setter Property="Visibility" Value="Visible" />
                                                            </DataTrigger>
                                                        </Style.Triggers>
                                                    </Style>
                                                </ItemsControl.Style>
                                                <ItemsControl.ItemTemplate>
                                                    <DataTemplate>
                                                        <Border Background="#F9F9F9" CornerRadius="4" Margin="0,0,0,5"
                                                                BorderThickness="1" BorderBrush="#E0E0E0" Padding="10">
                                                            <Grid>
                                                                <Grid.ColumnDefinitions>
                                                                    <ColumnDefinition Width="*" />
                                                                    <ColumnDefinition Width="Auto" />
                                                                    <ColumnDefinition Width="Auto" />
                                                                </Grid.ColumnDefinitions>
                                                                <TextBlock Grid.Column="0" Text="{Binding Menu.Name}" FontWeight="SemiBold" />
                                                                <TextBlock Grid.Column="1" Text="{Binding Quantity, StringFormat='x{0}'}" Margin="15,0" Foreground="#757575" />
                                                                <TextBlock Grid.Column="2" Text="{Binding Menu.TotalPrice, StringFormat='{}{0:C}'}" Foreground="#4CAF50" />
                                                            </Grid>
                                                        </Border>
                                                    </DataTemplate>
                                                </ItemsControl.ItemTemplate>
                                            </ItemsControl>
                                        </StackPanel>
                                    </Border>

                                    <!-- Status Change Card -->
                                    <Border Style="{StaticResource CardBorderStyle}"
                                            Visibility="{Binding SelectedOrder, Converter={StaticResource NullToVisibilityConverter}}">
                                <StackPanel>
                                            <TextBlock Text="Change Status" Style="{StaticResource SubHeaderTextStyle}" Margin="0,0,0,15" />
                                            <Button Content="Mark as Preparing" Margin="0,5"
                                            Command="{Binding UpdateOrderStatusCommand}" 
                                                    Style="{StaticResource StandardButtonStyle}"
                                                    Background="#F39C12"
                                                    HorizontalAlignment="Stretch"
                                                    CommandParameter="{x:Static models:OrderStatus.preparing}">
                                            </Button>
                                            <Button Content="Mark as Out for Delivery" Margin="0,5"
                                            Command="{Binding UpdateOrderStatusCommand}" 
                                                    Style="{StaticResource StandardButtonStyle}"
                                                    Background="#3498DB"
                                                    HorizontalAlignment="Stretch"
                                                    CommandParameter="{x:Static models:OrderStatus.out_for_delivery}">
                                            </Button>
                                            <Button Content="Mark as Delivered" Margin="0,5"
                                            Command="{Binding UpdateOrderStatusCommand}" 
                                                    Style="{StaticResource StandardButtonStyle}"
                                                    HorizontalAlignment="Stretch"
                                                    CommandParameter="{x:Static models:OrderStatus.delivered}">
                                            </Button>
                                        </StackPanel>
                                    </Border>
                                </StackPanel>
                            </ScrollViewer>
                        </Grid>
                    </Grid>
                </TabItem>

                <!-- Low Stock Dishes Tab -->
                <TabItem Header="Low Stock Items">
                    <Grid Margin="10">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="*" />
                        </Grid.RowDefinitions>

                        <Border Grid.Row="0" Style="{StaticResource CardBorderStyle}" Margin="0,0,0,15">
                            <StackPanel>
                                <TextBlock Text="Manage Low Stock Items" Style="{StaticResource SubHeaderTextStyle}" Margin="0,0,0,10" />
                            <Button Content="Refresh Low Stock Items" Command="{Binding LoadLowStockDishesCommand}" 
                                        Style="{StaticResource NeutralButtonStyle}" HorizontalAlignment="Left" />
                        </StackPanel>
                        </Border>

                        <ListView Grid.Row="1" ItemsSource="{Binding LowStockDishes}" 
                                  SelectedItem="{Binding SelectedDish, Mode=TwoWay}"
                                  Style="{StaticResource ListViewStyle}">
                            <ListView.View>
                                <GridView>
                                    <GridViewColumn Header="Name" Width="250" DisplayMemberBinding="{Binding Name}" />
                                    <GridViewColumn Header="Category" Width="150">
                                        <GridViewColumn.CellTemplate>
                                            <DataTemplate>
                                                <TextBlock Text="{Binding Category.Name}" />
                                            </DataTemplate>
                                        </GridViewColumn.CellTemplate>
                                    </GridViewColumn>
                                    <GridViewColumn Header="Total Quantity (g)" Width="150">
                                        <GridViewColumn.CellTemplate>
                                            <DataTemplate>
                                                <TextBlock Text="{Binding TotalQuantity}" HorizontalAlignment="Right" />
                                            </DataTemplate>
                                        </GridViewColumn.CellTemplate>
                                    </GridViewColumn>
                                    <GridViewColumn Header="Portion Size (g)" Width="150">
                                        <GridViewColumn.CellTemplate>
                                            <DataTemplate>
                                                <TextBlock Text="{Binding PortionSize}" HorizontalAlignment="Right" />
                                            </DataTemplate>
                                        </GridViewColumn.CellTemplate>
                                    </GridViewColumn>
                                    <GridViewColumn Header="Available Portions" Width="150">
                                        <GridViewColumn.CellTemplate>
                                            <DataTemplate>
                                                <TextBlock Text="{Binding AvailablePortions}" HorizontalAlignment="Right">
                                                    <TextBlock.Style>
                                                        <Style TargetType="TextBlock">
                                                            <Style.Triggers>
                                                                <DataTrigger Binding="{Binding AvailablePortions}" Value="0">
                                                                    <Setter Property="Foreground" Value="#E74C3C" />
                                                                    <Setter Property="FontWeight" Value="SemiBold" />
                                                                </DataTrigger>
                                                                <DataTrigger Binding="{Binding AvailablePortions, Converter={StaticResource LessThanConverter}, ConverterParameter=5}" Value="True">
                                                                    <Setter Property="Foreground" Value="#F39C12" />
                                                                    <Setter Property="FontWeight" Value="SemiBold" />
                                                                </DataTrigger>
                                                            </Style.Triggers>
                                                        </Style>
                                                    </TextBlock.Style>
                                                </TextBlock>
                                            </DataTemplate>
                                        </GridViewColumn.CellTemplate>
                                    </GridViewColumn>
                                </GridView>
                            </ListView.View>
                        </ListView>
                    </Grid>
                </TabItem>

                <!-- Categories Tab -->
                <TabItem Header="Categories">
                    <Grid Margin="10">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="*" />
                        </Grid.RowDefinitions>

                        <Border Grid.Row="0" Style="{StaticResource CardBorderStyle}" Margin="0,0,0,15">
                            <StackPanel>
                                <TextBlock Text="Manage Categories" Style="{StaticResource SubHeaderTextStyle}" Margin="0,0,0,10" />
                                <StackPanel Orientation="Horizontal">
                            <Button Content="Add Category" Command="{Binding AddCategoryCommand}" 
                                            Style="{StaticResource StandardButtonStyle}" />
                            <Button Content="Edit Category" Command="{Binding EditCategoryCommand}" 
                                            Style="{StaticResource NeutralButtonStyle}" />
                            <Button Content="Delete Category" Command="{Binding DeleteCategoryCommand}" 
                                            Style="{StaticResource DangerButtonStyle}" />
                            <Button Content="Refresh" Command="{Binding LoadCategoriesCommand}" 
                                            Style="{StaticResource NeutralButtonStyle}" />
                                </StackPanel>
                        </StackPanel>
                        </Border>

                        <ListView Grid.Row="1" ItemsSource="{Binding Categories}" 
                                  SelectedItem="{Binding SelectedCategory, Mode=TwoWay}"
                                  Style="{StaticResource ListViewStyle}">
                            <ListView.View>
                                <GridView>
                                    <GridViewColumn Header="ID" Width="50" DisplayMemberBinding="{Binding IdCategory}" />
                                    <GridViewColumn Header="Name" Width="200" DisplayMemberBinding="{Binding Name}" />
                                </GridView>
                            </ListView.View>
                        </ListView>
                    </Grid>
                </TabItem>

                <!-- Dishes Tab -->
                <TabItem Header="Dishes">
                    <Grid Margin="10">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="*" />
                        </Grid.RowDefinitions>

                        <Border Grid.Row="0" Style="{StaticResource CardBorderStyle}" Margin="0,0,0,15">
                            <StackPanel>
                                <TextBlock Text="Manage Dishes" Style="{StaticResource SubHeaderTextStyle}" Margin="0,0,0,10" />
                                <StackPanel Orientation="Horizontal">
                            <Button Content="Add Dish" Command="{Binding AddDishCommand}" 
                                            Style="{StaticResource StandardButtonStyle}" />
                            <Button Content="Edit Dish" Command="{Binding EditDishCommand}" 
                                            Style="{StaticResource NeutralButtonStyle}" />
                            <Button Content="Delete Dish" Command="{Binding DeleteDishCommand}" 
                                            Style="{StaticResource DangerButtonStyle}" />
                            <Button Content="Refresh" Command="{Binding LoadDishesCommand}" 
                                            Style="{StaticResource NeutralButtonStyle}" />
                                </StackPanel>
                        </StackPanel>
                        </Border>

                        <ListView Grid.Row="1" ItemsSource="{Binding Dishes}" 
                                  SelectedItem="{Binding SelectedDish, Mode=TwoWay}"
                                  Style="{StaticResource ListViewStyle}">
                            <ListView.View>
                                <GridView>
                                    <GridViewColumn Header="ID" Width="50" DisplayMemberBinding="{Binding IdDish}" />
                                    <GridViewColumn Header="Name" Width="200" DisplayMemberBinding="{Binding Name}" />
                                    <GridViewColumn Header="Category" Width="150">
                                        <GridViewColumn.CellTemplate>
                                            <DataTemplate>
                                                <TextBlock Text="{Binding Category.Name}" />
                                            </DataTemplate>
                                        </GridViewColumn.CellTemplate>
                                    </GridViewColumn>
                                    <GridViewColumn Header="Price" Width="100">
                                        <GridViewColumn.CellTemplate>
                                            <DataTemplate>
                                                <TextBlock Text="{Binding Price, StringFormat='{}{0:C}'}" 
                                                           Foreground="#4CAF50" FontWeight="SemiBold"
                                                           HorizontalAlignment="Right" />
                                            </DataTemplate>
                                        </GridViewColumn.CellTemplate>
                                    </GridViewColumn>
                                    <GridViewColumn Header="Portion Size (g)" Width="120">
                                        <GridViewColumn.CellTemplate>
                                            <DataTemplate>
                                                <TextBlock Text="{Binding PortionSize}" HorizontalAlignment="Right" />
                                            </DataTemplate>
                                        </GridViewColumn.CellTemplate>
                                    </GridViewColumn>
                                    <GridViewColumn Header="Total Quantity (g)" Width="120">
                                        <GridViewColumn.CellTemplate>
                                            <DataTemplate>
                                                <TextBlock Text="{Binding TotalQuantity}" HorizontalAlignment="Right" />
                                            </DataTemplate>
                                        </GridViewColumn.CellTemplate>
                                    </GridViewColumn>
                                </GridView>
                            </ListView.View>
                        </ListView>
                    </Grid>
                </TabItem>

                <!-- Menus Tab -->
                <TabItem Header="Menus">
                    <Grid Margin="10">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="*" />
                        </Grid.RowDefinitions>

                        <Border Grid.Row="0" Style="{StaticResource CardBorderStyle}" Margin="0,0,0,15">
                            <StackPanel>
                                <TextBlock Text="Manage Menus" Style="{StaticResource SubHeaderTextStyle}" Margin="0,0,0,10" />
                                <StackPanel Orientation="Horizontal">
                            <Button Content="Add Menu" Command="{Binding AddMenuCommand}" 
                                            Style="{StaticResource StandardButtonStyle}" />
                            <Button Content="Edit Menu" Command="{Binding EditMenuCommand}" 
                                            Style="{StaticResource NeutralButtonStyle}" />
                            <Button Content="Delete Menu" Command="{Binding DeleteMenuCommand}" 
                                            Style="{StaticResource DangerButtonStyle}" />
                            <Button Content="Refresh" Command="{Binding LoadMenusCommand}" 
                                            Style="{StaticResource NeutralButtonStyle}" />
                                </StackPanel>
                        </StackPanel>
                        </Border>

                        <ListView Grid.Row="1" ItemsSource="{Binding Menus}" 
                                  SelectedItem="{Binding SelectedMenu, Mode=TwoWay}"
                                  Style="{StaticResource ListViewStyle}">
                            <ListView.View>
                                <GridView>
                                    <GridViewColumn Header="ID" Width="50" DisplayMemberBinding="{Binding IdMenu}" />
                                    <GridViewColumn Header="Name" Width="200" DisplayMemberBinding="{Binding Name}" />
                                    <GridViewColumn Header="Total Price" Width="100">
                                        <GridViewColumn.CellTemplate>
                                            <DataTemplate>
                                                <TextBlock Text="{Binding TotalPrice, StringFormat='{}{0:C}'}" 
                                                           Foreground="#4CAF50" FontWeight="SemiBold"
                                                           HorizontalAlignment="Right" />
                                            </DataTemplate>
                                        </GridViewColumn.CellTemplate>
                                    </GridViewColumn>
                                </GridView>
                            </ListView.View>
                        </ListView>
                    </Grid>
                </TabItem>

                <!-- Allergens Tab -->
                <TabItem Header="Allergens">
                    <Grid Margin="10">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="*" />
                        </Grid.RowDefinitions>

                        <Border Grid.Row="0" Style="{StaticResource CardBorderStyle}" Margin="0,0,0,15">
                            <StackPanel>
                                <TextBlock Text="Manage Allergens" Style="{StaticResource SubHeaderTextStyle}" Margin="0,0,0,10" />
                                <StackPanel Orientation="Horizontal">
                            <Button Content="Add Allergen" Command="{Binding AddAllergenCommand}" 
                                            Style="{StaticResource StandardButtonStyle}" />
                            <Button Content="Edit Allergen" Command="{Binding EditAllergenCommand}" 
                                            Style="{StaticResource NeutralButtonStyle}" />
                            <Button Content="Delete Allergen" Command="{Binding DeleteAllergenCommand}" 
                                            Style="{StaticResource DangerButtonStyle}" />
                            <Button Content="Refresh" Command="{Binding LoadAllergensCommand}" 
                                            Style="{StaticResource NeutralButtonStyle}" />
                                </StackPanel>
                        </StackPanel>
                        </Border>

                        <ListView Grid.Row="1" ItemsSource="{Binding Allergens}" 
                                  SelectedItem="{Binding SelectedAllergen, Mode=TwoWay}"
                                  Style="{StaticResource ListViewStyle}">
                            <ListView.View>
                                <GridView>
                                    <GridViewColumn Header="ID" Width="50" DisplayMemberBinding="{Binding IdAllergen}" />
                                    <GridViewColumn Header="Name" Width="200" DisplayMemberBinding="{Binding Name}" />
                                </GridView>
                            </ListView.View>
                        </ListView>
                    </Grid>
                </TabItem>
            </TabControl>
        </Grid>
    </Grid>
</UserControl> 